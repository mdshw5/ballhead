from celery import Celery
import ConfigParser
import subprocess

config = ConfigParser.RawConfigParser()
config.read('default.cfg')

celery = Celery('tasks', broker='amqp://guest@localhost//')

@celery.task
def add(x, y):
    return x + y

@celery.task
def run(command):
    p = subprocess.Popen(command,
                         shell=False,
                         stdout=subprocess.PIPE,
                         stderr=subprocess.PIPE)
    stdout, stderr = p.communicate()
    return (stdout, stderr)

